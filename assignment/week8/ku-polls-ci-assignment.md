---
title: Code Coverage and C.I. Assignment
---

## Reading

1. [Python Code Quality][real-python-code-quality] best practices & tools on RealPython.com.
2. [Travis-CI Getting Started Guide][travis-ci-tutorial] short instructions how to get started.
3. [Core CI Concepts for Beginners][travis-ci-concepts] apply to any C.I. service
4. (Optional) My [Test Code Coverage](/ISP/testing/code-coverage) write-up

[travis-ci-tutorial]: https://docs.travis-ci.com/user/tutorial/
[travis-ci-concepts]: https://docs.travis-ci.com/user/for-beginners/
[real-python-code-quality]: https://realpython.com/python-code-quality/

## Assignment

1. Use flake8 on your KU Polls project and revise the code until you don't get any errors or warnings from flake8.

2. Create a `config.cfg` file in your Django project to customize flake8, such as ignoring files in the `migrations` directory (not your code).  For example:
   
   ```
   [flake8] 
   # Django recommends allowing longer lines, such as in models
   max-line-length = 119
   # run doctests using PyFlakes
   doctests = True

   # ignore some errors. Separate codes with comma.
   # See Flake8 Configuration page for list of all errors & warnings.
   ignore =
       E302    # expected 2 blank lines, found 1

   exclude =
       # ignore virtual environments (not our code)
       env,
       venv,
       # migrations are autogenerated. Pointless to check coding style.
       migrations
   ```

3. Add docstring comments to all your classes and methods. 

4. Check docstring comments using pydocstyle (a Python extension).  You can combine this with flake8 by installing the package `flake8-docstrings`. Then use `flake8` to check everything.

5. Add Continuous Integration to your KU Polls project.  You have 2 choices:
   1. Use Travis-CI
   2. Use Github Actions
   - The CI server should run tests and code coverage
   - Whichever CI server you choose, you must understand what is going on and how to do it. Do not just copy someone else's configuration file(s).

6. Add a "badge" to your KU Polls README.md to show the results of CI tests.

7. Add Codecov to your C.I. workflow 

8. Add a Codecov "badge" to your KU Polls README.md, with a link to the Codecov report

You want `coverage` to report how well your tests cover your code.
You can create a `.coveragerc` file to restrict what files and functions (methods)
are analyzed by coverage, as described in the [Coverage Docs][coverage-docs].
For example (please don't *blindly copy* this):

```
[run]
# measure branch coverage
branch = True
# don't test the Python standard library
cover_pylib = False
# omit uninteresting files
omit =
    polls/tests.py
    polls/migrations/*
```

## Python Packages

Use "pip" to install any of these packages.

* flake8 - a code checking tool, descrited in the RealPython article
* pydocstyle - a stand-alone tool to check comments for compliance with PEP 257.
  - Has a command line option to select the Docstring style you want. Choices are "pep257", "google", and "numpy".
  - Usage:  pydocstyle --convention=google somefile.py
  - You can specify configuration options in a `setup.cfg` file (same as flake8) in section `[pydocstyle]`
* flake8-django - add Django specific checks to flake8
* flake8-docstrings - add docstring checking to Flake8. It uses `pydocstyle` for actual checking.


## Resources

* Python [Coverage Documentation][coverage-docs] 
* [CodeCov.io](https://codecov.io) online code coverage service.
* [Using CodeCov with Python and Travis-CI](https://medium.com/datadriveninvestor/beginners-guide-to-using-codecov-with-python-and-travis-ci-c17659bb711) short guide for beginners.

[coverage-docs]: https://coverage.readthedocs.io/ "coverage.py documentation"

