---
title: KU Polls Iteration 4
---

## Goal for Iteration 4

The objective of this iteration is to produce a good quality app that others
can install and run.

### 1. New and Revised Functionality

1. List of polls displays all published polls, not just newest polls. Polls are sorted by date, from newest to oldest.
2. A user can delete his own vote on a poll, provided the poll is still open for voting.

### 2. Automation using Github

1. Create a Github Action to automatically run unit tests.
   - Use Python 3.11
   - Provide values of externalized vars (`DEBUG`, `SECRET_KEY`, ...) suitable for testing.
   - Two ways to provide variable values:
     1. set environment variables in your action script
     2. provide a testing.env file that your action script renames to .env in the action

2. Include a status badge in README, **after** the title line.

### 3. Review and Clean-up

1. Review and revise the poll questions, as needed.
   - Questions must be written in good English
   - Choices must be sufficient for the question
   - Example: "*What's your favorite car brand?*" should have more choices than just Honda, Toyota, and Mazda!

2. README.md
   - No stupid title lines like "ku-polls". Should be short and descriptive.
   Must have this content
   - first section describes the app
   - "Installation" section contains a **link** to `Installation.md` file in the repo
   - "Running the Application" or "How to Run" containing steps to run it in a virtual env.
   - "Demo Users" (or similar text) has a table of logins & passwords created by the data fixture
   - "Project Documents"
   - No **colons** in section titles
     ```
     ## Running the Application:  <--- wrong. No colon.
     ```

3. Create a Markdown file `Installation.md` containing instructions for how to install and configure your app.
   - clone or download the code from Github
   - create a virtual environment and install dependencies
   - how to set values for externalized variables
   - running migrations
   - how to run tests
   - install data from the data fixtures
   - **anything else** that needs to be done during installation
   - Installation.md is in your source repo instead of the wiki, so that anyone who clones your repo or downloads a "Release" will have this file.

4. Test your installation instructions. 
   - Create a fresh clone from Github and follow your instructions, line by line.

5. Use flake8 (with flake8-docstrings) to find and fix coding issues, incorrect docstrings, and unused imports.    
   A few exceptions to flake8 code analysis are allowed such as:
   - ignore files autogenerated by Django (migrations, mysite files)
   - lines in models can be up to 100 chars long
   - ignore minor issues like missing docstring in `__init__.py` files

### 4. Create a Tag for "Release Candidate" on Github

To signal that your code is ready for others to test please do this:

1. Add a **tag** "v1.0.0-rc1" to your Github repo.
2. Check the box in the KU Polls Peer Review spreadsheet and please try to contact the reviewer, too.

You **do not** need to create a "release" for this -- just a **tag**.

**This must be done by Saturday evening.**

### 5. Peer Review (Due by Sunday, 8PM)

Everyone is assigned to install and test someone else's KU Polls.

1. Clone the most recent code on the student's repo -- even if it is newer than the "v1.0.0-rc1" tag.  Everything on the master branch is "ready to deploy", so this should be fine.

2. Install according to `Installation.md` and run it. Report issues on their Issue Tracker.

3. Record all issue numbers for your issues in the Peer Testing spreadsheet on Google Docs.

### 6. Resolve & Close All Issues

Fix all the issues (if any) that your peer reviewer reports.  

When you close an issue **you must provide a description of what you did and why you are closing the issue**.
If you close an issue without "fixing" it, explain why.

### 7. Create a Release 1.0.0 and Tag on Github

After peer review and resolving all issues, push your work to Github and
create a `v1.0.0` tag and `1.0.0` Release of your code on Github.  

Include:

- a good description of what features are included or not implemented in this release.  Write how to report issues.
- a tag using a standard format. Github recommends using the "v" prefix, i.e. `v1.0.0`.

### Help for Github Releases

See: <https://docs.github.com/en/repositories/releasing-projects-on-github/managing-releases-in-a-repository>

Good Examples of Releases: [Python Packaging Authority (pypa)](https://github.com/pypa/) but there are some inconsistency in release naming and tags ("v" prefix or not). Good descriptions. 

[Semantic Versioning](https://semver.org/) describes the meaning of the 3 numbers in a release (1.0.21), and when to increment the version.  Some projects (pipenv) use Date Versioning, e.g. 2024.9.8, but we're not doing that here.

### Process Requirements

1. Create an Iteration 4 Plan in your wiki.
2. Add Iteration 4 tasks to your Project and to an "Iteration 4" task board.
   - Also convert tasks to "Issues".
3. Do work on an `iteration4` branch and push it to Github regularly.
4. When finished, open a PR and merge into `main` (of course).
5. Get peer feedback.  Fix all issues using a branch, OK to use `iteration4` branch. You can merge again into `main` when done.

### Data Fixtures

This time create 3 data files.

- Data for Question and Choices only (no Votes)
  ```
  python manage.py dumpdata --indent=2 -o data/polls-v4.json polls.question polls.choice
  ```
- Data for Votes
  ```
  python manage.py dumpdata --indent=2 -o data/votes-v4.json polls.vote
  ```
- The auth.user data in a file `data/users.json`
  ```
  python manage.py dumpdata --indent=2 -o data/users.json auth.user
  ```

Be careful: if you dump *all* data from the `auth` app (not just `auth.user`), there may be conflicts when you try to import the data. This is because migrations add some data to the `auth` database tables.

By separating the Question and Choice data from other data, someone can install a "clean" polls app with your questions but without any users or votes.

You can load all 3 files in one command:
```
python manage.py loaddata data/polls-v4.json data/votes-v4.json data/users.json
```

### Resources

- [Data Import and Export](https://cpske.github.io/ISP/django/data-import-export), my summary.
- [Providing Initial Data for Models](https://docs.djangoproject.com/en/stable/howto/initial-data/) in the official Django docs.
- [Data Migrations](https://realpython.com/data-migrations/) on RealPython.com describes how to create a migration for initial data.
